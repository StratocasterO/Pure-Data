#N canvas -8 -8 1680 972 10;
#X obj 944 550 cnv 15 340 404 empty empty empty 20 12 0 14 #e0e0e0
#404040 0;
#X obj 948 520 cnv 15 90 51 empty empty empty 20 12 0 14 #ff9f9f #404040
0;
#X obj 150 60 cnv 15 389 297 empty empty empty 20 12 0 14 #e0e0e0 #404040
0;
#X obj 958 861 cnv 15 478 101 empty empty empty 20 12 0 14 #cecece
#404040 0;
#X obj 562 59 cnv 15 316 436 empty empty empty 20 12 0 14 #e0e0e0 #404040
0;
#X obj 630 80 cnv 15 172 41 empty empty empty 20 12 0 14 #ff9f9f #404040
0;
#X obj 160 150 cnv 15 127 166 empty empty empty 20 12 0 14 #cecece
#404040 0;
#X obj 150 390 cnv 15 181 607 empty empty empty 20 12 0 14 #e0e0e0
#404040 0;
#X obj 280 550 cnv 15 295 376 empty empty empty 20 12 0 14 #cecece
#404040 0;
#N canvas 0 0 450 300 (subpatch) 0;
#X array weights 12 float 3 black black;
#A 0 6.35 2.23 3.48 2.33 4.38 4.09 2.52 5.19 2.39 3.66 2.29 2.88;
#X coords 0 7 12 2 200 140 1;
#X restore 960 70 graph;
#X obj 362 69 notein;
#X obj 362 159 spigot;
#X obj 402 239 f;
#X obj 452 239 + 1;
#X obj 362 209 t f b;
#X msg 442 69 0;
#X obj 382 319 tabwrite input;
#N canvas 536 233 450 305 (subpatch) 0;
#X array input 100 float 3 black black;
#A 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0;
#X coords 0 11 100 0 200 140 1;
#X restore 960 310 graph;
#X msg 442 159 \; input const 0;
#X obj 362 249 % 12;
#N canvas 536 233 450 305 (subpatch) 0;
#X array hist 12 float 3 black black;
#A 0 10 0 0 0 0 0 0 0 0 0 0 0;
#X coords 0 10 12 0 175 140 1;
#X restore 1210 310 graph;
#X obj 640 200 until;
#X obj 640 230 f;
#X obj 690 230 + 1;
#X obj 640 320 tabread input;
#X obj 640 260 t f f;
#X obj 720 230 % 100;
#X text 220 40 guarda el pitchlass de les notes tocades;
#X obj 640 440 tabwrite hist;
#X obj 640 380 tabread hist;
#X obj 640 410 + 1;
#X obj 640 350 t f f;
#X msg 960 460 \; input const 0;
#X msg 710 190 \; hist const 0;
#X text 570 280 agafa les 10 notes anteriors, f 9;
#X text 791 190 reinicia l'histograma, f 14;
#X text 668 84 mida de la finestra (es pot canviar), f 21;
#X text 570 40 actualitza l'histograma amb cada nota introduïda;
#X obj 310 620 until;
#X obj 310 650 f;
#X obj 370 650 + 1;
#X obj 310 790 tabread hist;
#X obj 400 790 tabread weights;
#X obj 310 820 *;
#X obj 310 850 t f b;
#X obj 350 880 f;
#X obj 310 880 +;
#X msg 360 620 0;
#X obj 290 910 f;
#X text 336 820 multiplica histograma i pesos;
#X text 388 614 reinicia contador i acumulador, f 23;
#X text 380 880 acumulador (producte escalar);
#X text 316 910 mostra l'ultim valor;
#X obj 310 680 t f f f;
#X msg 290 560 12;
#X obj 290 590 t b f b;
#N canvas 0 0 450 300 (subpatch) 0;
#X array scores 12 float 3 black black;
#A 0 63.5 28.8 22.9 36.6 23.9 51.9 25.2 40.9 43.8 23.3 34.8 22.3;
#X coords 0 150 12 0 175 140 1;
#X restore 1210 70 graph;
#X msg 160 400 12;
#X obj 160 460 until;
#X obj 160 490 f;
#X obj 230 490 + 1;
#X msg 210 460 0;
#X obj 160 940 tabwrite scores;
#X obj 160 430 t f b;
#X text 337 531 calcula la puntuació per una tonalitat;
#X obj 482 239 % 100;
#X obj 640 160 t f b;
#X obj 570 260 % 100;
#X obj 600 170 101;
#X obj 600 200 -;
#X obj 570 230 +;
#X obj 402 269 t f f b f;
#X text 295 227 només guarda la pitchclass, f 10;
#X text 1212 450 C C# D D# E F F# G G# A A# B;
#X text 1212 210 C C# D D# E F F# G G# A A# B;
#X obj 400 760 % 12;
#X obj 160 520 t b f f f;
#X text 177 372 recorre les 12 tonalitats;
#X text 154 960 guarda la puntuació de cada tonalitat, f 20;
#X text 430 730 offset dels pesos per cada tonalitat, f 15;
#X obj 400 720 -;
#X obj 400 740 + 12;
#X obj 590 550 cnv 15 340 337 empty empty empty 20 12 0 14 #e0e0e0
#404040 0;
#X msg 600 560 12;
#X obj 620 620 until;
#X obj 620 650 f;
#X obj 680 650 + 1;
#X msg 740 620 0;
#X obj 650 710 tabread scores;
#X obj 620 680 t f f f;
#X obj 620 800 f;
#X text 644 800 posició;
#X obj 600 590 t b f b;
#X text 680 530 buscador valor més gran;
#X text 754 800 valor més gran;
#X obj 650 740 moses 0;
#X floatatom 720 800 5 0 0 0 - - -, f 5;
#X obj 600 830 f;
#X floatatom 600 860 5 0 0 0 - - -, f 5;
#X text 769 614 reinicia el comptador \, el moses i la memòria, f
23;
#X obj 690 770 t b f;
#X obj 954 549 tgl 15 0 empty empty empty 17 7 0 10 #fcfcfc #000000
#000000 1 1;
#X obj 968 931 noteout;
#X obj 954 620 f;
#X obj 1004 620 + 1;
#X obj 954 650 t f f;
#X obj 1034 620 % 4;
#X msg 954 740 0;
#X msg 984 740 7;
#X msg 1044 740 7;
#X obj 954 800 +;
#X msg 1014 740 5;
#X obj 954 680 sel 0 1 2 3;
#X obj 1074 710 t b b b;
#X obj 1164 710 t b b b;
#X msg 1134 740 7;
#X msg 1224 740 7;
#X obj 1074 800 +;
#X msg 1074 740 0;
#X msg 1104 740 4;
#X msg 1164 740 -1;
#X msg 1194 740 2;
#X obj 1068 931 noteout;
#X obj 954 770 + 36;
#X obj 1074 770 + 48;
#X obj 954 590 metro 600;
#X obj 332 289 t b b b f;
#X obj 167 185 sel 0;
#X msg 167 241 0;
#X obj 197 214 t b;
#X msg 197 241 120;
#X obj 1068 901 makenote 70 1000;
#X obj 968 901 makenote 70 300;
#X msg 960 220 \; weights 0 6.35 2.23 3.48 2.33 4.38 4.09 2.52 5.19
2.39 3.66 2.29 2.88, f 34;
#X obj 1151 581 t b f;
#X msg 1151 608 60000;
#X obj 1151 638 /;
#X obj 1248 521 cnv 15 199 56 empty empty empty 20 12 0 14 #ff9f9f
#404040 0;
#X obj 1258 551 tgl 15 0 empty empty empty 17 7 0 10 #fcfcfc #000000
#000000 0 1;
#X obj 1378 551 tgl 15 0 empty empty empty 17 7 0 10 #fcfcfc #000000
#000000 0 1;
#X text 1278 551 MIDI Windows;
#X text 1398 551 Reaper;
#X obj 1308 901 makenote 70 1000;
#X obj 1208 901 makenote 70 300;
#X obj 968 871 spigot;
#X obj 1068 871 spigot;
#X obj 1208 871 spigot;
#X obj 1308 871 spigot;
#X obj 1208 931 noteout 2;
#X obj 1308 931 noteout 3;
#X text 1292 521 MIDI output toggle;
#X text 1288 581 NOTA: si se selecciona la sortida pel DAW \, també
s'ha de canviar la sortida MIDI a la configuració de Pd, f 36;
#X text 958 961 seleccionador de sortides MIDI;
#X text 960 270 (Pesos extrets de l'article de Krumhansl i Cuddy);
#X obj 187 290 noteout 1;
#X obj 160 85 cnv 15 127 55 empty empty empty 20 12 0 14 #ff9f9f #404040
0;
#X obj 200 112 tgl 15 0 empty empty empty 17 7 0 10 #fcfcfc #000000
#000000 1 1;
#X text 170 85 constant velocity;
#X obj 167 160 spigot;
#X obj 250 160 == 0;
#X obj 217 183 spigot;
#X text 181 318 melody output;
#X text 952 520 acompanyament;
#X text 634 861 pitch-class de la tonalitat detectada;
#X text 984 771 baix;
#X text 1104 771 acords;
#X text 1580 490 comment;
#X text 800 1060 comment, f 9;
#X obj 1139 521 cnv 15 90 56 empty empty empty 20 12 0 14 #ff9f9f #404040
0;
#X floatatom 1153 551 5 0 0 0 - - -, f 5;
#X text 1168 521 tempo;
#X text 1187 551 bpm;
#X msg 640 90 10;
#X connect 10 0 11 0;
#X connect 10 0 154 0;
#X connect 10 1 11 1;
#X connect 10 1 158 0;
#X connect 10 1 160 0;
#X connect 11 0 14 0;
#X connect 12 0 71 0;
#X connect 13 0 65 0;
#X connect 14 0 19 0;
#X connect 14 1 12 0;
#X connect 15 0 12 1;
#X connect 15 0 18 0;
#X connect 19 0 126 0;
#X connect 21 0 22 0;
#X connect 22 0 25 0;
#X connect 23 0 26 0;
#X connect 24 0 31 0;
#X connect 25 0 24 0;
#X connect 25 1 23 0;
#X connect 26 0 22 1;
#X connect 29 0 30 0;
#X connect 30 0 28 0;
#X connect 31 0 29 0;
#X connect 31 1 28 1;
#X connect 38 0 39 0;
#X connect 39 0 53 0;
#X connect 40 0 39 1;
#X connect 41 0 43 0;
#X connect 42 0 43 1;
#X connect 43 0 44 0;
#X connect 44 0 46 0;
#X connect 44 1 45 0;
#X connect 45 0 46 1;
#X connect 46 0 45 1;
#X connect 46 0 48 1;
#X connect 47 0 39 1;
#X connect 47 0 45 1;
#X connect 48 0 62 0;
#X connect 53 0 41 0;
#X connect 53 1 80 0;
#X connect 53 2 40 0;
#X connect 54 0 55 0;
#X connect 55 0 48 0;
#X connect 55 1 38 0;
#X connect 55 2 47 0;
#X connect 57 0 63 0;
#X connect 58 0 59 0;
#X connect 59 0 76 0;
#X connect 60 0 59 1;
#X connect 61 0 59 1;
#X connect 63 0 58 0;
#X connect 63 1 61 0;
#X connect 65 0 12 1;
#X connect 66 0 21 0;
#X connect 66 1 33 0;
#X connect 67 0 22 1;
#X connect 68 0 69 0;
#X connect 69 0 70 1;
#X connect 70 0 67 0;
#X connect 71 0 16 1;
#X connect 71 1 13 0;
#X connect 71 2 68 0;
#X connect 71 3 70 0;
#X connect 75 0 42 0;
#X connect 76 0 54 0;
#X connect 76 1 62 1;
#X connect 76 2 80 1;
#X connect 76 3 60 0;
#X connect 80 0 81 0;
#X connect 81 0 75 0;
#X connect 83 0 92 0;
#X connect 84 0 85 0;
#X connect 85 0 89 0;
#X connect 86 0 85 1;
#X connect 87 0 85 1;
#X connect 87 0 90 1;
#X connect 87 0 95 1;
#X connect 88 0 95 0;
#X connect 89 0 88 0;
#X connect 89 1 90 1;
#X connect 89 2 86 0;
#X connect 90 0 97 1;
#X connect 92 0 97 0;
#X connect 92 1 84 0;
#X connect 92 2 87 0;
#X connect 95 1 100 0;
#X connect 97 0 98 0;
#X connect 97 0 110 1;
#X connect 97 0 117 1;
#X connect 100 0 90 0;
#X connect 100 1 95 1;
#X connect 100 1 96 0;
#X connect 101 0 125 0;
#X connect 103 0 105 0;
#X connect 104 0 106 0;
#X connect 105 0 112 0;
#X connect 105 1 104 0;
#X connect 106 0 103 1;
#X connect 107 0 123 0;
#X connect 108 0 123 0;
#X connect 109 0 123 0;
#X connect 110 0 144 0;
#X connect 110 0 146 0;
#X connect 111 0 123 0;
#X connect 112 0 107 0;
#X connect 112 0 113 0;
#X connect 112 1 108 0;
#X connect 112 2 111 0;
#X connect 112 2 114 0;
#X connect 112 3 109 0;
#X connect 113 0 118 0;
#X connect 113 1 119 0;
#X connect 113 2 115 0;
#X connect 114 0 120 0;
#X connect 114 1 121 0;
#X connect 114 2 116 0;
#X connect 115 0 124 0;
#X connect 116 0 124 0;
#X connect 117 0 145 0;
#X connect 117 0 147 0;
#X connect 118 0 124 0;
#X connect 119 0 124 0;
#X connect 120 0 124 0;
#X connect 121 0 124 0;
#X connect 123 0 110 0;
#X connect 124 0 117 0;
#X connect 125 0 103 0;
#X connect 126 0 83 0;
#X connect 126 1 57 0;
#X connect 126 2 172 0;
#X connect 126 3 16 0;
#X connect 127 0 128 0;
#X connect 127 1 129 0;
#X connect 128 0 154 1;
#X connect 129 0 130 0;
#X connect 130 0 154 1;
#X connect 131 0 122 0;
#X connect 131 1 122 1;
#X connect 132 0 102 0;
#X connect 132 1 102 1;
#X connect 134 0 135 0;
#X connect 134 1 136 1;
#X connect 135 0 136 0;
#X connect 136 0 125 1;
#X connect 138 0 144 1;
#X connect 138 0 145 1;
#X connect 139 0 146 1;
#X connect 139 0 147 1;
#X connect 142 0 149 0;
#X connect 142 1 149 1;
#X connect 143 0 148 0;
#X connect 143 1 148 1;
#X connect 144 0 132 0;
#X connect 145 0 131 0;
#X connect 146 0 143 0;
#X connect 147 0 142 0;
#X connect 156 0 158 1;
#X connect 156 0 159 0;
#X connect 158 0 127 0;
#X connect 159 0 160 1;
#X connect 160 0 154 1;
#X connect 169 0 134 0;
#X connect 172 0 66 0;
#X connect 172 0 69 1;
